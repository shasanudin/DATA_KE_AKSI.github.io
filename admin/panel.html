<h2>Editor Alur DTSEN</h2>

<textarea id="editor" style="width:100%;height:300px;"></textarea>
<button onclick="save()">Simpan</button>

<script>
const OWNER = "USERNAME_GITHUB"
const REPO = "REPO_NAME"
const PATH = "data/alur.json"

async function load() {
  let res = await fetch(`https://raw.githubusercontent.com/${OWNER}/${REPO}/main/${PATH}`)
  editor.value = await res.text()
}

load()
</script>

<script>
const TOKEN = "GITHUB_PAT"

async function save() {
  let file = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${PATH}`)
  let info = await file.json()

  let content = btoa(unescape(encodeURIComponent(editor.value)))

  await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${PATH}`, {
    method: "PUT",
    headers: {
      Authorization: `token ${TOKEN}`
    },
    body: JSON.stringify({
      message: "Update alur.json",
      content: content,
      sha: info.sha
    })
  })

  alert("Alur berhasil disimpan!")
}
</script>

